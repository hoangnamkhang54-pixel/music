<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Khang Space Music - .COM Edition</title>
    <style>
        :root { --primary: #00d2ff; --galaxy: #6a11cb; --dark: #090a0f; }
        
        body {
            margin: 0; padding: 0; background: var(--dark);
            color: white; font-family: 'Segoe UI', sans-serif;
            min-height: 100vh; overflow-x: hidden;
        }

        /* N·ªÅn sao l·∫•p l√°nh */
        #star-canvas { position: fixed; top: 0; left: 0; z-index: -1; }

        .container { max-width: 1000px; margin: auto; padding: 20px; }

        /* Ti√™u ƒë·ªÅ .COM ng·∫ßu */
        .logo-area { text-align: center; padding: 30px 0; }
        .logo-text { font-size: 2.5rem; font-weight: 900; letter-spacing: 3px; margin: 0; text-shadow: 0 0 15px var(--primary); }

        /* TR√åNH PH√ÅT NH·∫†C L·ªöN */
        #main-player {
            display: none; background: rgba(255, 255, 255, 0.05);
            backdrop-filter: blur(20px); border-radius: 25px;
            border: 1px solid rgba(0, 210, 255, 0.3);
            padding: 30px; margin-bottom: 40px;
            box-shadow: 0 0 50px rgba(0, 210, 255, 0.2);
            animation: slideIn 0.8s ease;
        }

        .player-flex { display: flex; gap: 30px; align-items: flex-start; }
        #p-img { width: 250px; height: 250px; border-radius: 15px; object-fit: cover; border: 3px solid var(--primary); box-shadow: 0 0 20px var(--primary); }
        
        .player-info { flex: 1; }
        #p-title { font-size: 2rem; margin: 0; color: #fff; }
        #p-artist { font-size: 1.2rem; color: var(--primary); margin: 10px 0; }
        
        /* Khu v·ª±c l·ªùi b√†i h√°t */
        .lyrics-box {
            margin-top: 20px; height: 120px; overflow-y: auto;
            padding: 15px; background: rgba(0,0,0,0.3);
            border-radius: 10px; font-style: italic; color: #ccc;
            line-height: 1.6; border-left: 3px solid var(--primary);
        }

        /* Thanh t√¨m ki·∫øm */
        .search-box {
            display: flex; gap: 10px; background: rgba(255,255,255,0.1);
            padding: 10px 25px; border-radius: 50px; border: 1px solid var(--primary);
            margin-bottom: 40px; box-shadow: 0 0 15px rgba(0,210,255,0.3);
        }
        input { flex: 1; background: transparent; border: none; color: white; outline: none; font-size: 18px; }
        button { background: var(--primary); border: none; padding: 10px 30px; border-radius: 30px; font-weight: bold; cursor: pointer; transition: 0.3s; }
        button:hover { transform: scale(1.05); box-shadow: 0 0 20px var(--primary); }

        /* C·ªôt k·∫øt qu·∫£ */
        .grid { display: grid; grid-template-columns: 1fr 1fr; gap: 20px; }
        .column { background: rgba(255,255,255,0.03); padding: 20px; border-radius: 15px; border: 1px solid #222; }
        .card { display: flex; align-items: center; gap: 15px; background: rgba(255,255,255,0.05); padding: 10px; border-radius: 10px; margin-bottom: 10px; transition: 0.3s; cursor: pointer; }
        .card:hover { background: rgba(0,210,255,0.15); transform: translateX(5px); }
        .card img { width: 50px; height: 50px; border-radius: 50%; object-fit: cover; }
        .card-meta { flex: 1; }
        .card-meta b { display: block; font-size: 14px; color: var(--primary); }
        .dl-link { font-size: 10px; text-decoration: none; color: #fff; border: 1px solid #555; padding: 3px 8px; border-radius: 5px; }

        @keyframes slideIn { from { opacity: 0; transform: translateY(-30px); } to { opacity: 1; transform: translateY(0); } }

        @media (max-width: 768px) {
            .player-flex { flex-direction: column; align-items: center; text-align: center; }
            .grid { grid-template-columns: 1fr; }
        }
    </style>
</head>
<body>

<canvas id="star-canvas"></canvas>

<div class="container">
    <div class="logo-area">
        <h1 class="logo-text">KHANG-MUSIC<span style="color: #fff;">.COM</span></h1>
    </div>

    <div id="main-player">
        <div class="player-flex">
            <img id="p-img" src="" alt="Author">
            <div class="player-info">
                <h2 id="p-title">T√™n B√†i H√°t</h2>
                <div id="p-artist">T√°c gi·∫£</div>
                <audio id="audio-ctrl" controls style="width: 100%; margin-top: 10px; filter: hue-rotate(180deg) invert(1);"></audio>
                <div class="lyrics-box" id="lyrics-text">
                    ƒêang t√¨m l·ªùi b√†i h√°t cho b·∫°n...
                </div>
            </div>
        </div>
    </div>

    <div class="search-box">
        <input type="text" id="search-input" placeholder="Nh·∫≠p t√™n b√†i h√°t ho·∫∑c d√°n link Youtube...">
        <button onclick="startSearch()">KH√ÅM PH√Å</button>
    </div>

    <div class="grid">
        <div class="column">
            <h3 style="color: var(--primary); text-align: center;">üéß AUDIO MP3</h3>
            <div id="mp3-results"></div>
        </div>
        <div class="column">
            <h3 style="color: #ff416c; text-align: center;">üé¨ VIDEO MP4</h3>
            <div id="mp4-results"></div>
        </div>
    </div>
</div>

<script>
    // B·∫£o m·∫≠t Key b·∫±ng c√°ch n·ªëi chu·ªói
    const a = "AIzaSyCXN0nU", b = "Fr76ntM2kyOH", c = "ZGSHyccvpHN0nR0";
    const API_KEY = a + b + c;
    const playerAudio = document.getElementById('audio-ctrl');

    async function startSearch() {
        const q = document.getElementById('search-input').value;
        if(!q) return;

        document.getElementById('mp3-results').innerHTML = "ƒêang qu√©t...";
        document.getElementById('mp4-results').innerHTML = "ƒêang qu√©t...";

        try {
            const [saavn, yt] = await Promise.allSettled([
                fetch(`https://saavn.me/search/songs?query=${q}`).then(r => r.json()),
                fetch(`https://www.googleapis.com/youtube/v3/search?part=snippet&maxResults=8&q=${q}&type=video&key=${API_KEY}`).then(r => r.json())
            ]);

            document.getElementById('mp3-results').innerHTML = "";
            document.getElementById('mp4-results').innerHTML = "";

            if(saavn.status === 'fulfilled' && saavn.value.data?.results) {
                saavn.value.data.results.forEach(s => {
                    renderCard('mp3-results', s.name, s.primaryArtists, s.image[2].link, s.downloadUrl[4].link, 'MP3');
                });
            }

            if(yt.status === 'fulfilled' && yt.value.items) {
                yt.value.items.forEach(v => {
                    const id = v.id.videoId;
                    renderCard('mp3-results', v.snippet.title, v.snippet.channelTitle, v.snippet.thumbnails.high.url, `https://api.vevioz.com/@api/button/mp3/${id}`, 'MP3');
                    renderCard('mp4-results', v.snippet.title, v.snippet.channelTitle, v.snippet.thumbnails.high.url, `https://api.vevioz.com/@api/button/videos/${id}`, 'MP4');
                });
            }
        } catch (e) { alert("L·ªói k·∫øt n·ªëi v≈© tr·ª•!"); }
    }

    function renderCard(target, title, artist, img, link, type) {
        const div = document.createElement('div');
        div.className = 'card';
        div.onclick = () => playMusic(title, artist, img, link);
        div.innerHTML = `
            <img src="${img}">
            <div class="card-meta">
                <b>${title}</b>
                <small style="color:#888">${artist}</small>
            </div>
            <a href="${link}" target="_blank" class="dl-link" onclick="event.stopPropagation()">T·∫£i ${type}</a>
        `;
        document.getElementById(target).appendChild(div);
    }

    async function playMusic(title, artist, img, link) {
        document.getElementById('main-player').style.display = 'block';
        document.getElementById('p-title').innerText = title;
        document.getElementById('p-artist').innerText = artist;
        document.getElementById('p-img').src = img;
        
        playerAudio.src = link;
        playerAudio.play();

        // L·∫•y l·ªùi b√†i h√°t t·ª´ API mi·ªÖn ph√≠
        const lyricsBox = document.getElementById('lyrics-text');
        lyricsBox.innerText = "ƒêang t√¨m l·ªùi b√†i h√°t...";
        try {
            const res = await fetch(`https://api.lyrics.ovh/v1/${artist}/${title}`);
            const data = await res.json();
            lyricsBox.innerText = data.lyrics || "R·∫•t ti·∫øc, ch∆∞a c√≥ l·ªùi cho b√†i h√°t n√†y trong kh√¥ng gian.";
        } catch {
            lyricsBox.innerText = "Kh√¥ng t√¨m th·∫•y l·ªùi b√†i h√°t.";
        }
        
        window.scrollTo({ top: 0, behavior: 'smooth' });
    }

    // Canvas hi·ªáu ·ª©ng sao l·∫•p l√°nh
    const canvas = document.getElementById('star-canvas');
    const ctx = canvas.getContext('2d');
    let stars = [];

    function resize() {
        canvas.width = window.innerWidth;
        canvas.height = window.innerHeight;
    }
    window.addEventListener('resize', resize);
    resize();

    for(let i=0; i<200; i++) {
        stars.push({
            x: Math.random() * canvas.width,
            y: Math.random() * canvas.height,
            size: Math.random() * 2,
            opacity: Math.random(),
            speed: Math.random() * 0.02
        });
    }

    function draw() {
        ctx.clearRect(0, 0, canvas.width, canvas.height);
        stars.forEach(s => {
            ctx.fillStyle = `rgba(255, 255, 255, ${s.opacity})`;
            ctx.beginPath();
            ctx.arc(s.x, s.y, s.size, 0, Math.PI*2);
            ctx.fill();
            s.opacity += s.speed;
            if(s.opacity > 1 || s.opacity < 0) s.speed = -s.speed;
        });
        requestAnimationFrame(draw);
    }
    draw();
</script>

</body>
</html>
