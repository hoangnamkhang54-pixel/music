<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Khang Music Pro - .COM</title>
    <style>
        :root { --primary: #00d2ff; --dark: #050505; --bg-card: rgba(255,255,255,0.07); }
        body { margin: 0; padding: 0; background: var(--dark); color: white; font-family: 'Segoe UI', sans-serif; min-height: 100vh; }
        #star-canvas { position: fixed; top: 0; left: 0; z-index: -1; }
        .container { max-width: 900px; margin: auto; padding: 20px; }
        .logo { text-align: center; font-size: 2.2rem; font-weight: 900; color: var(--primary); margin: 20px 0; text-shadow: 0 0 15px var(--primary); }

        /* PLAYER L·ªöN */
        #player-section {
            display: none; background: rgba(255,255,255,0.1); backdrop-filter: blur(20px);
            border-radius: 20px; border: 1px solid var(--primary); padding: 25px; margin-bottom: 30px;
            animation: fadeIn 0.5s ease;
        }
        .player-wrap { display: flex; gap: 25px; flex-wrap: wrap; }
        #p-img { width: 250px; height: 250px; border-radius: 15px; object-fit: cover; box-shadow: 0 0 20px var(--primary); }
        .player-detail { flex: 1; min-width: 250px; }
        .lyrics-area {
            margin-top: 15px; height: 150px; overflow-y: auto; padding: 15px;
            background: rgba(0,0,0,0.4); border-radius: 10px; font-size: 14px;
            line-height: 1.6; border-left: 3px solid var(--primary); color: #ddd;
        }

        /* SEARCH */
        .search-box { display: flex; gap: 10px; margin-bottom: 30px; }
        input { flex: 1; padding: 12px 20px; border-radius: 30px; border: 1px solid var(--primary); background: transparent; color: white; outline: none; }
        button { padding: 12px 25px; border-radius: 30px; border: none; background: var(--primary); font-weight: bold; cursor: pointer; color: #000; }

        /* LIST */
        .list-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(280px, 1fr)); gap: 15px; }
        .card { display: flex; align-items: center; gap: 12px; background: var(--bg-card); padding: 10px; border-radius: 12px; cursor: pointer; transition: 0.3s; }
        .card:hover { background: rgba(0,210,255,0.2); transform: translateY(-3px); }
        .card img { width: 60px; height: 60px; border-radius: 8px; }
        .card-info b { display: block; color: var(--primary); font-size: 14px; }
        .card-info span { font-size: 12px; color: #aaa; }

        @keyframes fadeIn { from { opacity: 0; transform: translateY(-10px); } to { opacity: 1; transform: translateY(0); } }
    </style>
</head>
<body>

<canvas id="star-canvas"></canvas>

<div class="container">
    <div class="logo">KHANG-MUSIC.COM</div>

    <div id="player-section">
        <div class="player-wrap">
            <img id="p-img" src="" alt="Album Art">
            <div class="player-detail">
                <h2 id="p-title" style="margin:0">T√™n b√†i h√°t</h2>
                <div id="p-artist" style="color:var(--primary); margin:5px 0">T√°c gi·∫£</div>
                <audio id="main-audio" controls style="width:100%; margin-top:10px;"></audio>
                <div class="lyrics-area" id="lyrics-content">L·ªùi b√†i h√°t s·∫Ω hi·ªán ·ªü ƒë√¢y...</div>
            </div>
        </div>
    </div>

    <div class="search-box">
        <input type="text" id="inp" placeholder="Nh·∫≠p b√†i h√°t ho·∫∑c ca sƒ©...">
        <button onclick="searchMusic()">KH√ÅM PH√Å</button>
    </div>

    <div class="list-grid" id="results"></div>
</div>

<script>
    const audio = document.getElementById('main-audio');

    async function searchMusic() {
        const query = document.getElementById('inp').value;
        if(!query) return;
        
        const resDiv = document.getElementById('results');
        resDiv.innerHTML = "üì° ƒêang k·∫øt n·ªëi v·ªá tinh...";

        try {
            // S·ª≠ d·ª•ng iTunes API ƒë·ªÉ l·∫•y th√¥ng tin b√†i h√°t + T√°c gi·∫£ + ·∫¢nh chu·∫©n
            const response = await fetch(`https://itunes.apple.com/search?term=${query}&media=music&limit=12`);
            const data = await response.json();
            
            resDiv.innerHTML = "";
            data.results.forEach(track => {
                const div = document.createElement('div');
                div.className = 'card';
                
                // L·∫•y ·∫£nh ch·∫•t l∆∞·ª£ng cao 600x600
                const bigImg = track.artworkUrl100.replace('100x100bb', '600x600bb');
                
                // ·ªû b·∫£n n√†y, m√¨nh d√πng YouTube Search ng·∫ßm ƒë·ªÉ l·∫•y link ph√°t nh·∫°c t·ª´ t√™n b√†i + ca sƒ©
                div.onclick = () => loadTrack(track.trackName, track.artistName, bigImg);
                
                div.innerHTML = `
                    <img src="${track.artworkUrl100}">
                    <div class="card-info">
                        <b>${track.trackName}</b>
                        <span>${track.artistName}</span>
                    </div>
                `;
                resDiv.appendChild(div);
            });
        } catch (e) { resDiv.innerHTML = "‚ùå L·ªói t√¨m ki·∫øm."; }
    }

    async function loadTrack(name, artist, img) {
        document.getElementById('player-section').style.display = 'block';
        document.getElementById('p-title').innerText = name;
        document.getElementById('p-artist').innerText = artist;
        document.getElementById('p-img').src = img;
        window.scrollTo({ top: 0, behavior: 'smooth' });

        // L·∫•y link nh·∫°c (T√¨m ID video t·ª´ YouTube d·ª±a tr√™n t√™n + ca sƒ©)
        const KEY = "AIzaSyCXN0nU" + "Fr76ntM2kyOH" + "ZGSHyccvpHN0nR0";
        try {
            const ytRes = await fetch(`https://www.googleapis.com/youtube/v3/search?part=snippet&q=${name} ${artist}&maxResults=1&type=video&key=${KEY}`).then(r => r.json());
            const videoId = ytRes.items[0].id.videoId;
            audio.src = `https://api.vevioz.com/@api/button/mp3/${videoId}`;
            audio.play();
        } catch { alert("Kh√¥ng th·ªÉ ph√°t nh·∫°c b√†i n√†y."); }

        // L·∫•y l·ªùi b√†i h√°t
        const lBox = document.getElementById('lyrics-content');
        lBox.innerText = "‚è≥ ƒêang t·∫£i l·ªùi b√†i h√°t...";
        try {
            const lRes = await fetch(`https://api.lyrics.ovh/v1/${artist}/${name}`).then(r => r.json());
            lBox.innerText = lRes.lyrics || "üöÄ Giai ƒëi·ªáu tuy·ªát v·ªùi nh∆∞ng ch∆∞a c√≥ l·ªùi trong kho d·ªØ li·ªáu.";
        } catch { lBox.innerText = "Kh√¥ng t√¨m th·∫•y l·ªùi."; }
    }

    // V·∫Ω sao n·ªÅn cho ng·∫ßu
    const cvs = document.getElementById('star-canvas');
    const ctx = cvs.getContext('2d');
    function resize() { cvs.width = window.innerWidth; cvs.height = window.innerHeight; }
    window.onresize = resize; resize();
    let stars = Array(100).fill().map(() => ({x:Math.random()*cvs.width, y:Math.random()*cvs.height, s:Math.random()*2}));
    function draw() {
        ctx.clearRect(0,0,cvs.width,cvs.height); ctx.fillStyle = "white";
        stars.forEach(st => { ctx.beginPath(); ctx.arc(st.x, st.y, st.s, 0, 7); ctx.fill(); });
        requestAnimationFrame(draw);
    }
    draw();
</script>
</body>
</html>
